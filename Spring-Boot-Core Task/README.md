# 1주차 과제

## 요구사항

- **Spring Boot 프로젝트**를 작성한다.
- **Spring Boot 3.2.5**, **Java 21** 기준으로 작성한다.
- 제공하는 상수도 요금표와 회원 정보를 메모리에 로드하고, 로그인한 사용자가 상수도 요금을 계산할 수 있는 프로그램을 작성한다.
- 프로젝트는 **CLI**를 통해서 input을 받고 적절한 응답 값을 반환한다.
- **Spring Shell** 방식을 추천.
    - Spring Shell 적용이 어렵다면, 다른 라이브러리를 사용하거나 직접 구현해도 된다. 다만 비즈니스 로직과 input 처리 부분의 코드는 분리하도록 한다.
    - 예: `ApplicationRunner`에 `Scanner` 적용.
- 함수나 명령어의 이름은 예제와 반드시 일치할 필요는 없다.
- 요금 계산은 단순히 구간금액(원)과 사용량을 곱한 값을 사용하면 된다.
- 쉘 환경에서 통합테스트가 잘 안 되면 다음 옵션을 붙여주세요: `@SpringBootTest(properties = {"spring.shell.interactive.enabled=false"})`

## 기능 (입출력 예제)

### 로그인 기능
![로그인 기능](/image/2024-06-03 1.png)

### 로그아웃 기능
![로그아웃 기능](/image/2024-06-03 2.png)

### 현재 접속 중인 계정 정보를 알 수 있는 기능
![현재 접속 중인 계정 정보](/image/2024-06-03 3.png)

### 지자체명 목록을 알 수 있는 기능
![지자체명 목록](/image/2024-06-03 4.png)

### 업종 목록을 알 수 있는 기능
![업종 목록](/image/2024-06-03 5.png)

### 구간금액을 알 수 있는 기능
![구간금액](/image/2024-06-03 6.png)

### 사용량에 따른 금액을 알 수 있는 기능 (한/영 지원)
![사용량에 따른 금액 한글](/image/2024-06-03 7.png)
![사용량에 따른 금액 영어](/image/2024-06-03 8.png)

### 사용자 로그인 기록을 로그로 남기는 기능
![사용자 로그인 기록](/image/2024-06-03 9.png)

### 사용자 조회 요청을 로그로 남기는 기능
![사용자 조회 요청](/image/2024-06-03 10.png)

## 구현 요구사항

- **파일을 파싱하는 스프링 빈 생성**
    - 인터페이스 필요.
    - `Conditional`을 이용하여 `Property`에 따라서 다른 빈을 사용하도록 설정 (csv, json).
    - 파일 파싱은 원하는 라이브러리를 import해서 사용 가능. 라이브러리를 사용하지 않을 경우 직접 구현.
    - `property` 값을 변경하여 csv 파일 파싱에서 json 파일 파싱으로 전환 가능.

- **사용자 결과 값(Output 포맷)을 생성하는 스프링 빈 생성**
    - 인터페이스 필요.
    - `Profile`에 따라서 영어 혹은 한글로 된 결과 값을 생성.
    - `profile`에 따라 다른 빈을 사용해야 함.
    - `profile`만 바꿔도 응답 값이 바뀌어야 함.

- **로그인, 로그아웃을 구현한 스프링 빈 생성**
    - 반드시 인터페이스를 만들 필요는 없음.
    - 로그인 관련 구현은 서버 메모리를 이용 (객체 이용).
    - 단순 파일의 정보와 `equals` 비교를 통해서 로그인 시킴 (암호화 x).

- **로그인 기능 Aop와 요금 조회 기능 Aop 생성**
    - **로그인 관련 Aop 요구사항**
        - 사용자 로그인, 로그아웃 요청을 로깅하여 (id, pw) 평문으로 `account.log` 파일에 기록 (실서비스에서는 지양).
        - Aop의 적용 범위 - login, logout 요청을 로깅.

    - **요금 조회 기능 Aop 요구사항**
        - 어떤 요청을 보냈는지와 어떤 사용자가 요청을 보냈는지를 `price.log` 파일에 기록.
        - 로그인하지 않은 사용자의 경우 Aop에서 확인해서 오류를 반환.
        - Aop의 적용 범위 - login, logout 요청을 제외한 모든 요청.

    - **로그인 기능 Aop와 요금 조회 기능 Aop의 로그는 각각 다른 파일에 남기도록 설정**.

- **csv 및 json 파일의 경로는 외부 설정으로 받도록 설정**.

## 테스트 생성

- 커버리지는 50퍼센트를 넘길 것.
- 예외 상황에 대한 테스트는 적용할 것.
- `mock`, `spy`을 각각 1회 이상 적용할 것.
- 통합테스트가 반드시 필요하지는 않음.

## 논리 설계 (참고용)
![](/image/2024-06-03 11.png)

## 예제 실행 방법

```sh
java -jar demo-0.0.1-SNAPSHOT.jar

java -jar -Dspring.profiles.active=kor demo-0.0.1-SNAPSHOT.jar
